{"version":3,"file":"static/js/347.ae94482b.chunk.js","mappings":"oNAkCA,EAtBiCA,EAAAA,MAAW,YAAsC,IAApCC,EAAmC,EAAnCA,KAAMC,EAA6B,EAA7BA,MAAOC,EAAsB,EAAtBA,SAAUC,EAAY,EAAZA,OAE3DC,GAAWC,EAAAA,EAAAA,MAEjB,OACI,iBAAKC,UAAW,UAAhB,WACI,gBAAKC,MAAO,CAACC,OAAQ,WAAYC,QAAS,WACtCL,EAAS,YAAD,OAAaD,KADzB,UAGI,gBAAKG,UAAW,sBAAuBI,IAAKT,GAASU,EAAYC,IAAI,kBAEzE,4BACI,0BAAK,iBAAMN,UAAW,eAAjB,SAAkCJ,OAEvC,gBAAKI,UAAW,eAAhB,SACKN,a,kDCoBrB,IACA,EAAe,IAA0B,8DCMzC,EAxCmCD,EAAAA,MAAW,YAAe,IAAbc,EAAY,EAAZA,OAEtCC,GAAWC,EAAAA,EAAAA,MAEjB,GAIIC,EAAAA,EAAAA,IAAqB,CACrBC,aAAc,MACdC,cAAe,CACXC,QAAS,MANbC,EADJ,EACIA,SACAC,EAFJ,EAEIA,aACAC,EAHJ,EAGIA,MAQEC,EAAWF,GAAa,SAAAG,GAC1B,GAAIA,EAAKL,QAAQM,OAAQ,CACrB,IAAKD,EAAKL,QACN,OAEJL,GAASY,EAAAA,EAAAA,IAAcF,EAAKL,UAEhCG,OAGJ,OACI,gBAAKhB,UAAW,aAAhB,UACI,kBAAMiB,SAAUA,EAAhB,WACI,0BAAOI,SAAqB,UAAXd,EACVe,YAAa,8GACTR,EAAS,cAEpB,mBAAQO,SAAqB,YAAXd,EAAlB,UACI,gBAAKH,IAAKmB,EAAcjB,IAAI,yBCWhD,GAAekB,EAAAA,EAAAA,IAlDE,WAEb,IAAMhB,GAAWC,EAAAA,EAAAA,MACXgB,GAAWC,EAAAA,EAAAA,IAAe,SAAAC,GAAK,OAAIA,EAAMC,KAAKH,YAC9ClB,GAASmB,EAAAA,EAAAA,IAAe,SAAAC,GAAK,OAAIA,EAAMC,KAAKrB,UAC5CsB,GAAgBC,EAAAA,EAAAA,QAAuB,MAC7C,GAAwCC,EAAAA,EAAAA,WAAS,GAAjD,eAAOC,EAAP,KAAqBC,EAArB,MAEAC,EAAAA,EAAAA,YAAU,WAEN,OADA1B,GAAS2B,EAAAA,EAAAA,OACF,WACH3B,GAAS4B,EAAAA,EAAAA,UAEd,CAAC5B,KAEJ0B,EAAAA,EAAAA,YAAU,WACiB,IAAD,EAAdF,IACA,UAAAH,EAAcQ,eAAd,SAAuBC,eAAe,CAACC,SAAU,cAGzD,CAACd,IAaL,OACI,iBAAKzB,UAAW,eAAhB,WACI,gBAAKA,UAAW,4BAChB,iBAAKA,UAAW,YAAawC,SAZb,SAACC,GACrB,IAAMC,EAAUD,EAAEE,cACdC,KAAKC,IAAKH,EAAQI,aAAeJ,EAAQK,UAAaL,EAAQM,cAAgB,KAC7EhB,GAAgBC,GAAgB,GAEjCD,GAAgBC,GAAgB,IAOhC,UACKR,EAASwB,KAAI,SAACC,GAAD,OACV,SAAC,EAAD,CACSxD,KAAMwD,EAAGrC,QACTlB,MAAOuD,EAAGvD,MACVC,SAAUsD,EAAGtD,SACbC,OAAQqD,EAAGrD,QAJNqD,EAAGC,QAKrB,gBAAKC,IAAKvB,QAEd,SAAC,EAAD,CAAUtB,OAAQA,W,0GCjDvB,SAASiB,EAAoB6B,GAYhC,OAXA,SAA+BC,GAI3B,OAFgB5B,EAAAA,EAAAA,IAAe,SAAAC,GAAK,OAAIA,EAAM4B,KAAKC,YAK/C,SAACH,GAAD,UAAsBC,KAHL,SAAC,KAAD,CAAUG,GAAG","sources":["components/chat/Message.tsx","assets/svg/arrow-big.svg","components/chat/ChatForm.tsx","components/chat/Chat.tsx","components/hoc/withAuthRedirect.tsx"],"sourcesContent":["import React, {FC} from 'react';\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport userAvatar from \"../../assets/img/avatar.jpg\"\r\n\r\n\r\ntype MessageType = {\r\n    text: string,\r\n    photo: string\r\n    userName: string\r\n    userId: number\r\n}\r\n\r\nconst Message: FC<MessageType> = React.memo(({text, photo, userName, userId}) => {\r\n\r\n    const navigate = useNavigate();\r\n\r\n    return (\r\n        <div className={\"message\"}>\r\n            <div style={{cursor: \"pointer\"}} onClick={() => {\r\n                navigate(`/profile/${userId}`)\r\n            }}>\r\n                <img className={\"header__user_avatar\"} src={photo || userAvatar} alt=\"userAvatar\"/>\r\n            </div>\r\n            <div>\r\n                <div><span className={\"message-name\"}>{userName}</span>\r\n                </div>\r\n                <div className={\"message-text\"}>\r\n                    {text}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n})\r\n\r\nexport default Message;","var _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgArrowBig(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"send_24__Page-2\",\n    stroke: \"none\",\n    strokeWidth: 1,\n    fill: \"none\",\n    fillRule: \"evenodd\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"send_24__send_24\",\n    fill: \"none\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    id: \"send_24__Rectangle-76\",\n    d: \"M0 0h24v24H0z\",\n    fill: \"none\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M5.74 15.75a39.14 39.14 0 00-1.3 3.91c-.55 2.37-.95 2.9 1.11 1.78 2.07-1.13 12.05-6.69 14.28-7.92 2.9-1.61 2.94-1.49-.16-3.2C17.31 9.02 7.44 3.6 5.55 2.54c-1.89-1.07-1.66-.6-1.1 1.77.17.76.61 2.08 1.3 3.94a4 4 0 003 2.54l5.76 1.11a.1.1 0 010 .2L8.73 13.2a4 4 0 00-3 2.54z\",\n    id: \"send_24__Mask\",\n    fill: \"#818C99\"\n  })))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgArrowBig);\nexport default __webpack_public_path__ + \"static/media/arrow-big.66a207f8abb24707691615e9eb0168a0.svg\";\nexport { ForwardRef as ReactComponent };","import React, {FC} from 'react';\r\nimport {useForm} from \"react-hook-form\";\r\nimport {useDispatch} from \"react-redux\";\r\nimport {sendMessageTC, StatusType} from \"../../redux/reducers/chat\";\r\nimport arrowBigIcon from \"../../assets/svg/arrow-big.svg\"\r\n\r\ntype ChatFormType = {\r\n    status: StatusType\r\n}\r\n\r\ntype MessageType = {\r\n    message: string\r\n}\r\n\r\nconst ChatForm: FC<ChatFormType> = React.memo(({status}) => {\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const {\r\n        register,\r\n        handleSubmit,\r\n        reset,\r\n    } = useForm<MessageType>({\r\n        criteriaMode: \"all\",\r\n        defaultValues: {\r\n            message: \"\"\r\n        }\r\n    });\r\n\r\n    const onSubmit = handleSubmit(data => {\r\n        if (data.message.trim()) {\r\n            if (!data.message) {\r\n                return\r\n            }\r\n            dispatch(sendMessageTC(data.message))\r\n        }\r\n        reset()\r\n    })\r\n\r\n    return (\r\n        <div className={\"chat-input\"}>\r\n            <form onSubmit={onSubmit}>\r\n                <input disabled={status !== \"ready\"}\r\n                       placeholder={\"Напишите сообщение...\"}\r\n                       {...register(\"message\")}\r\n                />\r\n                <button disabled={status === \"pending\"}>\r\n                    <img src={arrowBigIcon} alt=\"sendButton\"/>\r\n                </button>\r\n            </form>\r\n        </div>\r\n    );\r\n})\r\n\r\nexport default ChatForm;","import React, {FC, useEffect, useRef, useState} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\nimport Message from \"./Message\";\r\nimport {WithAuthRedirect} from \"../hoc/withAuthRedirect\";\r\nimport {startMessagesListening, stopMessagesListening} from \"../../redux/reducers/chat\";\r\nimport {useAppSelector} from \"../../redux/store\";\r\nimport ChatForm from \"./ChatForm\";\r\n\r\nconst Chat: FC = () => {\r\n\r\n    const dispatch = useDispatch()\r\n    const messages = useAppSelector(state => state.chat.messages)\r\n    const status = useAppSelector(state => state.chat.status)\r\n    const chatAnchorRef = useRef<HTMLDivElement>(null)\r\n    const [isAutoScroll, setIsAutoScroll] = useState(true)\r\n\r\n    useEffect(() => {\r\n        dispatch(startMessagesListening())\r\n        return () => {\r\n            dispatch(stopMessagesListening())\r\n        }\r\n    }, [dispatch])\r\n\r\n    useEffect(() => {\r\n            if (isAutoScroll) {\r\n                chatAnchorRef.current?.scrollIntoView({behavior: \"smooth\"})\r\n            }\r\n        },\r\n        [messages])\r\n\r\n    // callbacks\r\n\r\n    const onScrollHandler = (e: React.UIEvent<HTMLDivElement, UIEvent>) => {\r\n        const element = e.currentTarget\r\n        if (Math.abs((element.scrollHeight - element.scrollTop) - element.clientHeight) < 500) {\r\n            !isAutoScroll && setIsAutoScroll(true)\r\n        } else {\r\n            isAutoScroll && setIsAutoScroll(false)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className={\"chat-content\"}>\r\n            <div className={\"chat-message-top-block\"}/>\r\n            <div className={\"chat-text\"} onScroll={onScrollHandler}>\r\n                {messages.map((el) =>\r\n                    <Message key={el.id}\r\n                             text={el.message}\r\n                             photo={el.photo}\r\n                             userName={el.userName}\r\n                             userId={el.userId}/>)}\r\n                <div ref={chatAnchorRef}/>\r\n            </div>\r\n            <ChatForm status={status}/>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default WithAuthRedirect(Chat)","import React, {ComponentType} from 'react';\r\nimport {Navigate} from 'react-router-dom';\r\nimport {useAppSelector} from \"../../redux/store\";\r\n\r\nexport function WithAuthRedirect<T>(WrappedComponent: ComponentType<T>) {\r\n    function ComponentWithRedirect(props: T) {\r\n\r\n        const isLogin = useAppSelector(state => state.auth.isLogin)\r\n\r\n        if (!isLogin) return <Navigate to=\"/login\"/>\r\n\r\n        return (\r\n            <WrappedComponent {...props}/>\r\n        )\r\n    }\r\n\r\n    return ComponentWithRedirect\r\n}"],"names":["React","text","photo","userName","userId","navigate","useNavigate","className","style","cursor","onClick","src","userAvatar","alt","status","dispatch","useDispatch","useForm","criteriaMode","defaultValues","message","register","handleSubmit","reset","onSubmit","data","trim","sendMessageTC","disabled","placeholder","arrowBigIcon","WithAuthRedirect","messages","useAppSelector","state","chat","chatAnchorRef","useRef","useState","isAutoScroll","setIsAutoScroll","useEffect","startMessagesListening","stopMessagesListening","current","scrollIntoView","behavior","onScroll","e","element","currentTarget","Math","abs","scrollHeight","scrollTop","clientHeight","map","el","id","ref","WrappedComponent","props","auth","isLogin","to"],"sourceRoot":""}